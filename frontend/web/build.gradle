apply plugin: 'org.jetbrains.kotlin.js'
apply plugin: 'distribution'

archivesBaseName = 'sdk-search'

// TODO umd
kotlin {
  target {
    useCommonJs()
    browser()
  }

  sourceSets {
    main {
      dependencies {
        implementation project(':search:presenter')
        implementation project(':references')

        implementation deps.kotlin.stdlib.js
        implementation deps.kotlin.coroutines.js
        implementation deps.timber.js
      }
    }
  }
}

distributions {
  main {
    baseName = 'sdk-search'

    contents {
      from 'src/main/resources'
      // TODO https://youtrack.jetbrains.com/issue/KT-32209
      from "$buildDir/libs/SdkSearch-web.js"
    }
  }
}

distZip.dependsOn('browserWebpack')
installDist.dependsOn('browserWebpack')
distTar.enabled = false
